function sbxx_dr_read(e){var t="";t="devId="+e,$.ajax({type:"POST",url:"deviceImport/getDeviceImportDetail.action",timeout:6e4,dataType:"json",data:t,success:function(e){var t="";t+='<div class="table row"><form class="form-horizontal">',t+='<div class="form-group"><label class="col-sm-2 control-label">\u8bbe\u5907\u5382\u5546</label><div class="col-sm-2"><p class="form-control-static" id="devFactory">'+NoNull(e.devFactory)+"</p></div>",t+='<label class="col-sm-2 control-label">\u8bbe\u5907\u578b\u53f7</label><div class="col-sm-2"><p class="form-control-static" id="devModel">'+NoNull(e.devModel)+"</p></div>",t+='<label class="col-sm-2 control-label">\u8054\u7cfb\u4eba</label><div class="col-sm-2"><p class="form-control-static" id="devContacts">'+NoNull(e.devContacts)+"</p></div></div>",t+='<div class="form-group"><label class="col-sm-2 control-label">\u8054\u7cfb\u7535\u8bdd</label><div class="col-sm-2"><p class="form-control-static" id="devPhone">'+NoNull(e.devPhone)+"</p></div>",t+='<label class="col-sm-2 control-label">\u6279\u6b21</label><div class="col-sm-2"><p class="form-control-static" id="devBatch">'+NoNull(e.devBatch)+"</p></div>",t+='<label class="col-sm-2 control-label">\u8d28\u4fdd\u5230\u671f\u65f6\u95f4</label><div class="col-sm-2"><p class="form-control-static" id="devExpiredDate">'+NoNull(e.devExpiredDate)+"</p></div></div>",t+='<div class="form-group"><label class="col-sm-2 control-label">\u8bbe\u5907\u72b6\u6001</label><div class="col-sm-2"><p class="form-control-static" id="devAssetsStatus">'+devAssetsStatusCN(e.devAssetsStatus)+"</p></div>",t+='<label class="col-sm-2 control-label">\u5b89\u88c5\u72b6\u6001</label><div class="col-sm-2"><p class="form-control-static" id="isInstall">'+isInstallCN(e.isInstall)+"</p></div>",t+='<label class="col-sm-2 control-label">\u5bfc\u5165\u65f6\u95f4</label><div class="col-sm-2"><p class="form-control-static" id="updateTime">'+NoNull(e.updateTime)+"</p></div></div>",t+="</form></div>",BootstrapDialog.show({size:BootstrapDialog.SIZE_WIDE,title:"\u5bfc\u5165\u8bbe\u5907\u8be6\u60c5",message:t,onshown:function(e){},buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,t,l){"timeout"==t&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}function getDeviceImportCount(){$.ajax({type:"POST",url:"deviceImport/getDeviceImportCount.action",timeout:6e4,dataType:"json",data:data,success:function(e){$("#countDevAssetsStatusAll").html(e.countDevAssetsStatusAll),$("#countDevAssetsStatus0").html(e.countDevAssetsStatus0),$("#countDevAssetsStatus1").html(e.countDevAssetsStatus1),$("#countDevAssetsStatus2").html(e.countDevAssetsStatus2),$("#countDevAssetsStatus3").html(e.countDevAssetsStatus3),$("#countDevAssetsStatus5").html(e.countDevAssetsStatus5),$("#countIsInstall1").html(e.countIsInstall1),$("#countIsInstall2").html(e.countIsInstall2)},error:function(e,t,l){"timeout"==t&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}function queryParams_sbxx_dr(e){var t={limit:e.limit,offset:e.offset,car_type:car_type,devModel:$("#DeviceModel").val(),devBatch:$("#devBatch").val(),devAssetsStatus:$("#devAssetsStatus").val(),isInstall:$("#isInstall").val()};return t}getDevAssetsStatusType();var $table=$("#table-sbxx_dr");$table.bootstrapTable({method:"post",contentType:"application/x-www-form-urlencoded",url:"deviceImport/getDeviceImport.action",dataType:"json",striped:!0,toolbar:"#toolbar",uniqueId:"devId",pagination:!0,singleSelect:!1,idField:"devId",sortable:!1,sidePagination:"server",queryParams:queryParams_sbxx_dr,columns:[{title:"\u5e8f\u53f7",field:"id",align:"center",valign:"middle",formatter:function(e,t,l){return l+1}},{title:"\u8bbe\u5907\u578b\u53f7",field:"devModel",align:"center",valign:"middle"},{title:"\u8bbe\u5907\u5e8f\u5217\u53f7",field:"devMac",align:"center",valign:"middle",formatter:function(e,t,l){var a='<a href="javascript:void(0);" onclick="sbxx_dr_read('+t.devId+');">'+e+"</a>";return a}},{title:"\u6279\u6b21",field:"devBatch",align:"center",valign:"middle"},{title:"\u8bbe\u5907\u72b6\u6001",field:"devAssetsStatus",align:"center",valign:"middle",formatter:function(e,t,l){var a=devAssetsStatusCN(e);return a}},{title:"\u5b89\u88c5\u72b6\u6001",field:"isInstall",align:"center",valign:"middle",formatter:function(e,t,l){var a=isInstallCN(e);return a}}]}),$("#sbxx_dr").click(function(){var e="";e+='<div class="table row"><form class="form-horizontal" id="FormValidator">',e+='<br><div class="form-group"><label class="col-sm-3 control-label">\u5382\u5546</label><div class="col-sm-9"><select id="devFactory" name="devFactory" class="selectpicker form-control"><option value="">\u9009\u62e9\u5382\u5546</option></select></div></div>',e+='<div class="form-group"><label class="col-sm-3 control-label">\u8054\u7cfb\u4eba</label><div class="col-sm-9"><input type="text" id="devContacts" name="devContacts" class="form-control" placeholder="\u8f93\u5165\u8054\u7cfb\u4eba"></div></div>',e+='<div class="form-group"><label class="col-sm-3 control-label">\u7535\u8bdd</label><div class="col-sm-9"><input type="tel" id="devPhone" name="devPhone" class="form-control" placeholder="\u8f93\u5165\u7535\u8bdd\u53f7\u7801"></div></div>',e+='<div class="form-group"><label class="col-sm-3 control-label">\u6279\u6b21</label><div class="col-sm-9"><input type="text" id="devBatch2" name="devBatch2" class="form-control" placeholder="\u8f93\u5165\u6279\u6b21"></div></div>',e+='<div class="form-group"><label class="col-sm-3 control-label">\u578b\u53f7</label><div class="col-sm-9"><input type="text" id="devModel" name="devModel" class="form-control" placeholder="\u8f93\u5165\u578b\u53f7"></div></div>',e+='<div class="form-group"><label class="col-sm-3 control-label">\u8d28\u4fdd\u5230\u671f</label><div class="col-sm-9"><input type="text" id="devExpiredDate" name="devExpiredDate" class="form-control" placeholder="\u8f93\u5165\u8d28\u4fdd\u5230\u671f\u65f6\u95f4" readonly></div></div>',e+='<div class="form-group"><label class="col-sm-3 control-label">\u8bbe\u5907\u6e05\u5355</label><div class="col-sm-9"><input id="file_excel" name="file_excel" class="file" type="file" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"></div></div>',e+="</form></div>",BootstrapDialog.show({title:"\u8bbe\u5907\u4fe1\u606f\u5bfc\u5165",message:e,onshown:function(e){$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getDeviceFactory.action",dataType:"json",data:"car_type="+car_type,success:function(t){$.each(t,function(e,t){$("#devFactory").append('<option value="'+t.value+'">'+t.text+"</option>")}),$(".selectpicker").selectpicker("refresh"),$("#FormValidator").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{devFactory:{message:"\u5382\u5546\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u9009\u62e9\u5382\u5546"}}},devContacts:{message:"\u8054\u7cfb\u4eba\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u8f93\u5165\u8054\u7cfb\u4eba"}}},devPhone:{message:"\u7535\u8bdd\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u8f93\u5165\u7535\u8bdd"}}},devBatch2:{message:"\u6279\u6b21\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u8f93\u5165\u6279\u6b21"}}},devModel:{message:"\u578b\u53f7\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u8f93\u5165\u578b\u53f7"}}},devExpiredDate:{message:"\u8d28\u4fdd\u5230\u671f\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u9009\u62e9\u8d28\u4fdd\u5230\u671f\u65f6\u95f4"},date:{format:"YYYY-MM-DD",message:"\u65e5\u671f\u683c\u5f0f\u4e0d\u6b63\u786e"}}}}}),null==car_type&&(car_type=""),$("#file_excel").fileinput({language:"zh",uploadUrl:"deviceImport/saveDeviceImport.action",allowedFileExtensions:["xls","xlsx"],showPreview:!1,browseClass:"btn btn-primary",dropZoneEnabled:!1,maxFileCount:1,enctype:"multipart/form-data",validateInitialCount:!1,uploadExtraData:function(e,t){var l={devFactory:$("#devFactory").val(),devContacts:$("#devContacts").val(),devPhone:$("#devPhone").val(),devBatch:$("#devBatch2").val(),devModel:$("#devModel").val(),devExpiredDate:$("#devExpiredDate").val(),car_type:car_type};return l}}),$("#file_excel").on("change",function(e){$("#FormValidator").bootstrapValidator("validate"),$("#FormValidator").data("bootstrapValidator").isValid()||($("#file_excel").fileinput("reset"),BootstrapDialog.alert({title:"\u9a8c\u8bc1\u5931\u8d25",message:"\u8bf7\u786e\u8ba4\u8f93\u5165\u5185\u5bb9\u683c\u5f0f\u662f\u5426\u6b63\u786e\uff01",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"\u786e\u8ba4"}))}),$("#file_excel").on("fileuploaded",function(t,l,a,o){$("#table-sbxx_dr").bootstrapTable("refresh"),getDeviceImportCount();var s=l.response.code,i="";i+='<div class="table row"><div class="col-sm-2 text-center"><label>\u6210\u529f\uff1a</label>'+l.response.importSucc+'</div><div class="col-sm-2 text-center"><label>\u5931\u8d25\uff1a</label>'+l.response.importFail+"</div></div>",i+='<table id="table-sbxx_dr_jg">',i+="<thead><tr><th>\u8bbe\u5907\u5e8f\u5217\u53f7</th><th>\u5bfc\u5165\u4fe1\u606f</th><th>\u5bfc\u5165\u7ed3\u679c</th></tr></thead>",i+="<tbody>",l.response.result.inportInfo.forEach(function(e){i+="<tr><td>"+e.devSn+"</td><td>"+e.remarks+"</td><td>"+e.result+"</td></tr>"}),i+="</tbody>",i+="</table>",600007==s?(BootstrapDialog.show({size:BootstrapDialog.SIZE_WIDE,title:"\u5bfc\u5165\u7ed3\u679c\u67e5\u770b",message:i,onshown:function(e){$("#table-sbxx_dr_jg").bootstrapTable({pagination:!0,sidePagination:"client",pageSize:10,columns:[{align:"center",valign:"middle"},{align:"center",valign:"middle"},{align:"center",valign:"middle"}]})},buttons:[{label:"\u4e0b\u8f7d\u5931\u8d25\u8bbe\u5907\u5217\u8868",cssClass:"btn-primary",action:function(e){0==l.response.importFail?BootstrapDialog.alert({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u65e0\u5bfc\u5165\u5931\u8d25\u8bbe\u5907\uff0c\u65e0\u6cd5\u4e0b\u8f7d\u5931\u8d25\u8bbe\u5907\u5217\u8868\uff01",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"\u786e\u8ba4"}):window.open("deviceImport/downloadDeviceImportFail.action")}},{label:"\u5173\u95ed",action:function(e){e.close()}}]}),e.close()):BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:ConfigCN(s),buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}),$("#devExpiredDate").datetimepicker({format:"yyyy-mm-dd",autoclose:!0,minView:"month",maxView:"decade",language:"zh-CN"}).on("hide",function(e){$("#FormValidator").data("bootstrapValidator").updateStatus("devExpiredDate","NOT_VALIDATED",null).validateField("devExpiredDate")})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u8bbe\u5907\u5382\u5546\uff01")}})}})});var data="";void 0!=$.cookie("car_type")&&0!=$.cookie("car_type")&&(car_type=$.cookie("car_type"),data="car_type="+car_type),$.ajax({type:"post",url:"device/getDeviceModel.action",contentType:"application/json",dataType:"json",success:function(e){$.each(e,function(e,t){$("#DeviceModel").append('<option value="'+t.value+'">'+t.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u8bbe\u5907\u578b\u53f7\uff01")}}),getDeviceImportCount(),$("#serach_button").click(function(){$("#table-sbxx_dr").bootstrapTable("refresh")}),$("#sbxx_dr_download").click(function(){var e=$("#DeviceModel").val(),t=$("#devBatch").val(),l=$("#devAssetsStatus").val(),a=$("#isInstall").val();null==car_type&&(car_type=""),window.open("deviceImport/exportDeviceImport.action?devModel="+e+"&devBatch="+t+"&devAssetsStatus="+l+"&isInstall="+a+"&car_type="+car_type)}),$("#sbxx_dr_Template").click(function(e){window.open("excelTemplate/device_import_template.xlsx")});