function getHistoryVersion(){var t=echarts.init(document.getElementById("echarts_HistoryVersion"),"macarons");t.showLoading({text:"\u6b63\u5728\u52aa\u529b\u7684\u8bfb\u53d6\u6570\u636e\u4e2d..."});var a=echarts.init(document.getElementById("echarts_Coverage"),"macarons");a.showLoading({text:"\u6b63\u5728\u52aa\u529b\u7684\u8bfb\u53d6\u6570\u636e\u4e2d..."});var e="";e="startDate="+$("#datetimeStart").val()+"&endDate="+$("#datetimeEnd").val()+"&car_type="+car_type,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"devRealtimeInfo/getHistoryVersion.action",timeout:6e4,dataType:"json",data:e,success:function(e){var o=new Array,r=new Array;for(var i in e)"date"!=i&&"coverage"!=i&&o.push(i);7==e.coverage.length&&""==TodayData&&""==YesterdayData&&(TodayData=e.coverage[6],YesterdayData=e.coverage[5],Today_Yesterday=(TodayData-YesterdayData).toFixed(2)),$.each(o,function(t,a){r.push({name:a,type:"bar",stack:"\u5386\u53f2\u6570\u636e",data:e[a]})}),option2={title:{text:"\u57fa\u7ebf\u7248\u8986\u76d6\u7387\u8d8b\u52bf\u56fe",subtext:"portal\u57fa\u7ebf\u7248\u4eca\u65e5\u8986\u76d6\u7387\u4e3a"+TodayData+"%\uff0c\u8f83\u6628\u65e5\u65b0\u589e"+Today_Yesterday+"%",x:"center"},tooltip:{trigger:"axis",formatter:"{a} <br/>{b} : {c}%"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:e.date}],yAxis:[{type:"value"}],series:[{name:"\u57fa\u7ebf\u7248\u8986\u76d6\u7387",type:"line",stack:"%",data:e.coverage}]},a.hideLoading(),a.setOption(option2),option={title:{text:"\u57fa\u7ebf\u7248\u8986\u76d6\u7387\u5206\u5e03\u56fe",x:"center"},tooltip:{trigger:"axis",formatter:function(t){for(var a=t[0].name,e=0,o=t.length;o>e;e++)a+="<br/>"+t[e].seriesName+" : "+t[e].value+"%";return a},axisPointer:{type:"shadow"}},legend:{data:o,bottom:"0px"},grid:{left:"3%",right:"4%",containLabel:!0},xAxis:[{type:"category",data:e.date}],yAxis:[{type:"value",name:"\u5355\u4f4d\uff1a\uff08%\uff09",max:100,min:0}],series:r},t.hideLoading(),t.setOption(option)},error:function(t,a,e){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(t){t.close()}}]})}})}var date=new Date;$("#datetimeStart").val(moment().subtract(6,"days").format("YYYY-MM-DD")),$("#datetimeEnd").val(moment().format("YYYY-MM-DD"));var myChart=echarts.init(document.getElementById("echarts_portal"),"macarons");myChart.showLoading({text:"\u6b63\u5728\u52aa\u529b\u7684\u8bfb\u53d6\u6570\u636e\u4e2d..."});var data="";data="car_type="+car_type,$.ajax({type:"post",url:"devRealtimeInfo/getPortalVerison.action",timeout:6e4,dataType:"json",data:data,success:function(jsonResult){var arr=new Array;$.each(jsonResult,function(t,a){arr.push("'"+a.name+"'")});var dataItem=arr.join();""!=dataItem&&(dataItem=eval("["+dataItem+"]")),option={title:{text:"portal\u7248\u672c\u5206\u5e03",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{bottom:"0px",data:dataItem},series:[{name:"\u7248\u672c\u6570\u91cf",type:"pie",radius:"70%",label:{normal:{show:!0,formatter:"{b} : {c}",position:"top"}},data:jsonResult,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},myChart.hideLoading(),myChart.setOption(option)},error:function(t,a,e){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(t){t.close()}}]})}});var myChart2=echarts.init(document.getElementById("echarts_dma_info"),"macarons");myChart2.showLoading({text:"\u6b63\u5728\u52aa\u529b\u7684\u8bfb\u53d6\u6570\u636e\u4e2d..."});var data="";data="car_type="+car_type,$.ajax({type:"post",url:"devRealtimeInfo/getDMAVerison.action",timeout:6e4,dataType:"json",data:data,success:function(jsonResult){var arr=new Array,valueArr=new Array;$.each(jsonResult,function(t,a){arr.push("'"+a.name+"'"),valueArr.push(a.value)});var dataItem=arr.join(),valueItem=valueArr.join();""!=dataItem&&(dataItem=eval("["+dataItem+"]")),""!=valueItem&&(valueItem=eval("["+valueItem+"]")),option={title:{text:"DMA\u7248\u672c\u5206\u5e03",x:"center"},tooltip:{trigger:"axis"},legend:{data:dataItem,bottom:"0px"},xAxis:[{type:"category",axisLabel:{show:!0,interval:"auto"},data:dataItem}],yAxis:[{type:"value",name:"\u6570\u91cf\uff08\u4e2a\uff09",axisLabel:{formatter:"{value}"}}],series:[{name:"\u6570\u91cf",type:"bar",label:{normal:{show:!0,position:"top"}},data:valueItem}]},myChart2.hideLoading(),myChart2.setOption(option)},error:function(t,a,e){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(t){t.close()}}]})}}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){var a=$(t.target).text();$(t.relatedTarget).text();"\u5386\u53f2\u7248\u672c\u5206\u5e03\u6570\u636e"==a&&getHistoryVersion()}),$(".radioItem").change(function(){switch($(this).val()){case"1":$("#datetimeStart").val(moment().subtract(0,"days").format("YYYY-MM-DD")),$("#datetimeEnd").val(moment().subtract(0,"days").format("YYYY-MM-DD")),getHistoryVersion();break;case"7":$("#datetimeStart").val(moment().subtract(6,"days").format("YYYY-MM-DD")),$("#datetimeEnd").val(moment().subtract(0,"days").format("YYYY-MM-DD")),getHistoryVersion();break;case"30":$("#datetimeStart").val(moment().subtract(29,"days").format("YYYY-MM-DD")),$("#datetimeEnd").val(moment().subtract(0,"days").format("YYYY-MM-DD")),getHistoryVersion();break;default:$("#datetimeStart").val(moment().format("YYYY-MM-DD")),$("#datetimeEnd").val(moment().format("YYYY-MM-DD")),getHistoryVersion()}});var TodayData="",YesterdayData="",Today_Yesterday=0;$("#serach_button").click(function(){$('input:radio[name="DataDay"]:checked').prop("checked",!1).parent().removeClass("active"),getHistoryVersion()});var date=new Date;$(".datetimeStart").datetimepicker({format:"yyyy-mm-dd",autoclose:!0,minView:"month",maxView:"decade",language:"zh-CN"}).on("click",function(t){$(".datetimeStart").datetimepicker("setStartDate",moment().subtract(90,"days").format("YYYY-MM-DD")).datetimepicker("setEndDate",$("#datetimeEnd").val())}),$(".datetimeEnd").datetimepicker({format:"yyyy-mm-dd",autoclose:!0,minView:"month",maxView:"decade",language:"zh-CN"}).on("click",function(t){$(".datetimeEnd").datetimepicker("setStartDate",$("#datetimeStart").val()).datetimepicker("setEndDate",moment().format("YYYY-MM-DD"))});