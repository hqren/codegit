function getDeviceOffLineBureau(){var e=echarts.init(document.getElementById("echarts_lxsb"),"macarons");e.showLoading({text:"\u6b63\u5728\u52aa\u529b\u7684\u8bfb\u53d6\u6570\u636e\u4e2d..."}),$.ajax({type:"post",url:"deviceAlarm/getDeviceOffLineBureau.action",timeout:6e4,dataType:"json",data:data,success:function(t){var a=new Array;$.each(t,function(e,t){a.push(t.name)}),option={title:{text:"\u79bb\u7ebf\u8bbe\u5907\u8def\u5c40\u5360\u6bd4",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{show:!1,orient:"vertical",left:"left",data:a},series:[{name:"\u79bb\u7ebf\u8bbe\u5907\u8def\u5c40\u5360\u6bd4",type:"pie",radius:"60%",center:["50%","60%"],data:t,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{show:!0,formatter:"{b}	\n{c}	\n({d}%)"},labelLine:{show:!0}}}}]},e.hideLoading(),e.setOption(option)},error:function(e,t,a){"timeout"==t&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}function DeviceOnLineTrend(){var e="";e+="carType="+car_type;var t=echarts.init(document.getElementById("echarts_zxsb"),"macarons");t.showLoading({text:"\u6b63\u5728\u52aa\u529b\u7684\u8bfb\u53d6\u6570\u636e\u4e2d..."}),$.ajax({type:"post",url:"deviceAlarm/getDeviceOnLineTrend.action",timeout:6e4,dataType:"json",data:e,success:function(e){option={title:{text:"\u8bbe\u5907\u5728\u7ebf\u6570\u8d8b\u52bf\u56fe\uff08\u8fd130\u5929\uff09",x:"center"},grid:{top:"30%"},tooltip:{trigger:"axis"},xAxis:[{type:"category",axisLabel:{show:!0,interval:0},data:e.date}],yAxis:[{type:"value",name:"\u5728\u7ebf\u6570\uff08\u53f0\uff09",axisLabel:{formatter:"{value}"}}],series:[{name:"\u5728\u7ebf\u6570",type:"line",data:e.data,markLine:{label:{normal:{show:!0,position:"top"}},data:[{type:"average",name:"\u5e73\u5747\u503c"}]}}]},t.hideLoading(),t.setOption(option)},error:function(e,t,a){"timeout"==t&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}function getDeviceAlarmLog(){var e=$("#table-DeviceAlarmLog");e.bootstrapTable({method:"post",contentType:"application/x-www-form-urlencoded",url:"deviceAlarm/getDeviceAlarmLog.action",dataType:"json",striped:!0,toolbar:"#toolbar",uniqueId:"id",pagination:!0,singleSelect:!1,singleSelect:!0,sortable:!1,sidePagination:"server",queryParams:queryParams_DeviceAlarmLog,columns:[{title:"\u5e8f\u53f7",field:"id",align:"center",valign:"middle",formatter:function(e,t,a){return a+1}},{title:"\u544a\u8b66\u65f6\u95f4",field:"alarmTime",align:"center",valign:"middle"},{title:"\u544a\u8b66\u5185\u5bb9",field:"alarmContent",align:"center",valign:"middle"},{title:"\u901a\u77e5\u4eba\u5458",field:"alarmNoticeMail",align:"center",valign:"middle"},{title:"\u79bb\u7ebf\u8bbe\u5907\u5217\u8868",field:"alarmExcelUrl",align:"center",valign:"middle",formatter:function(e,t,a){var i="";return i+='<a href="/down/'+e+'" target="_blank">\u4e0b\u8f7d</a>'}}]})}function updateDeviceAlarmThreshold(){var e="";e="threshold="+$("#DeviceAlarmThreshold").val()+"&carType="+car_type,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"deviceAlarm/updateDeviceAlarmThreshold.action",timeout:6e4,dataType:"json",data:e,success:function(e){var t="";t=600009==e.result?e.message:ConfigCN[e.result],600005==e.result?errorNotify("",t,"success"):errorNotify(null,t)},error:function(e,t,a){"timeout"==t&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}function queryParams_DeviceAlarmLog(e){var t={limit:e.limit,offset:e.offset,carType:car_type};return t}$("#table-lxgj").bootstrapTable({pagination:!0,sidePagination:"client",pageSize:10,columns:[{align:"center",valign:"middle"},{align:"center",valign:"middle"},{align:"center",valign:"middle"},{align:"center",valign:"middle"},{align:"center",valign:"middle"},{align:"center",valign:"middle"}]}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=$(e.target).text();$(e.relatedTarget).text();if("\u79bb\u7ebf\u6570\u91cf\u544a\u8b66"==t){var a="";1==car_type?(a+='<div class="col-sm-6"><div id="echarts_lxsb" style="width: 100%;height:400px;"></div></div>',a+='<div class="col-sm-6"><div id="echarts_zxsb" style="width: 100%;height:400px;"></div></div>'):2==car_type&&(a+='<div class="col-sm-12"><div id="echarts_zxsb" style="width: 100%;height:400px;"></div></div>'),$("#echarts_show").html(a),1==car_type&&getDeviceOffLineBureau(),DeviceOnLineTrend(),getDeviceAlarmLog()}});var data="";data+="carType="+car_type,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"deviceAlarm/getDeviceAlarmThreshold.action",dataType:"json",data:data,success:function(e){$("#DeviceAlarmThreshold").val(e.result)},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u8bbe\u5907\u6570\u91cf\uff01")}});