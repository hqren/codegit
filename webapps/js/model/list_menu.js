function MenuLoad(carType){var MenuID="";1==carType?MenuID="#trainMenu":2==carType&&(MenuID="#carMenu");var data="";data="car_type="+carType,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/auth/querySystemAuth.action",dataType:"json",data:data,success:function(jsonResult){var setting={check:{enable:!0,chkStyle:"radio",radioType:"all"},data:{simpleData:{enable:!0}}},treeNodeArray=new Array,treeNodeObject=new Object;$.each(jsonResult,function(e,o){var a=new Object;a.id=o.id,a.pId=o.parentId,a.name=o.funcName,a.Url=o.url,a.domId=o.domId,treeNodeArray.push(a)});var zNodes=eval(treeNodeArray);$.fn.zTree.init($(MenuID),setting,zNodes)},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u83dc\u5355\u4fe1\u606f\uff01")}})}function MenuAdd(e,o){var a="",t="";1==e?a="trainMenu":2==e&&(a="carMenu");var l=0,s=$.fn.zTree.getZTreeObj(a),n=s.getCheckedNodes();$.each(n,function(e,o){l=o.id,t=o.name}),""!=t&&0!=o||(t="-"),o=0==l||0==o?-1:l;var c="";c+='<div class="row"><div class="col-sm-12"><form id="FormValidator" class="form-horizontal">',c+='<br><div class="form-group"><label class="col-sm-3 control-label">\u7236\u83dc\u5355</label><div class="col-sm-6"><p class="form-control-static">'+t+"</p></div></div>",c+='<div class="form-group"><label class="col-sm-3 control-label">\u540d\u79f0</label><div class="col-sm-6"><input type="text" id="funcName" name="funcName" class="form-control" placeholder="\u8bf7\u8f93\u5165\u540d\u79f0"></div></div>',c+='<div class="form-group"><label class="col-sm-3 control-label">Url</label><div class="col-sm-6"><input type="text" id="Url" name="Url" class="form-control" placeholder="\u8bf7\u8f93\u5165Url"></div></div>',c+='<div class="form-group"><label class="col-sm-3 control-label">domId</label><div class="col-sm-6"><input type="text" id="domId" name="domId" class="form-control" placeholder="\u8bf7\u8f93\u5165domId"></div></div>',c+="</form></div></div>",BootstrapDialog.show({title:"\u6dfb\u52a0\u83dc\u5355",message:c,onshown:function(e){},buttons:[{label:"\u63d0\u4ea4",cssClass:"btn-primary",action:function(a){var t="";t="car_type="+e+"&parentId="+o+"&funcName="+$("#funcName").val()+"&url="+$("#Url").val()+"&domId="+$("#domId").val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/auth/insertSystemAuth.action",timeout:6e4,dataType:"json",data:t,success:function(o){var t="";t=600009==o.result?o.message:ConfigCN[o.result],6e5==o.result&&(MenuLoad(e),a.close()),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,o,a){"timeout"==o&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}},{label:"\u5173\u95ed",action:function(e){e.close()}}]})}function MenuEdit(e){var o="",a="",t="",l="";1==e?o="trainMenu":2==e&&(o="carMenu");var s=0,n=$.fn.zTree.getZTreeObj(o),c=n.getCheckedNodes();if($.each(c,function(e,o){s=o.id,a=o.name,t=o.Url,l=o.domId}),0!=s){""==a&&(a="-");var r="";r+='<div class="row"><div class="col-sm-12"><form id="FormValidator" class="form-horizontal">',r+='<div class="form-group"><label class="col-sm-3 control-label">\u540d\u79f0</label><div class="col-sm-6"><input type="text" id="funcName" name="funcName" class="form-control" value="'+a+'" placeholder="\u8bf7\u8f93\u5165\u540d\u79f0"></div></div>',r+='<div class="form-group"><label class="col-sm-3 control-label">Url</label><div class="col-sm-6"><input type="text" id="Url" name="Url" class="form-control" value="'+t+'" placeholder="\u8bf7\u8f93\u5165Url"></div></div>',r+='<div class="form-group"><label class="col-sm-3 control-label">domId</label><div class="col-sm-6"><input type="text" id="domId" name="domId" class="form-control" value="'+l+'" placeholder="\u8bf7\u8f93\u5165domId"></div></div>',r+="</form></div></div>",BootstrapDialog.show({title:"\u4fee\u6539\u83dc\u5355",message:r,onshown:function(e){},buttons:[{label:"\u63d0\u4ea4",cssClass:"btn-primary",action:function(o){var a="";a="id="+s+"&car_type="+e+"&funcName="+$("#funcName").val()+"&url="+$("#Url").val()+"&domId="+$("#domId").val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/auth/updateSystemAuth.action",timeout:6e4,dataType:"json",data:a,success:function(a){var t="";t=600009==a.result?a.message:ConfigCN[a.result],600005==a.result&&(MenuLoad(e),o.close()),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,o,a){"timeout"==o&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}},{label:"\u5173\u95ed",action:function(e){e.close()}}]})}else BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u9009\u62e9\u9700\u8981\u4fee\u6539\u7684\u83dc\u5355\u9879\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}function MenuDel(e){var o="";1==e?o="trainMenu":2==e&&(o="carMenu");var a=0,t=$.fn.zTree.getZTreeObj(o),l=t.getCheckedNodes();$.each(l,function(e,o){a=o.id}),0!=a?BootstrapDialog.confirm({title:"\u5220\u9664\u786e\u8ba4\u63d0\u9192",message:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u6240\u9009\u62e9\u83dc\u5355\uff1f",closable:!0,draggable:!0,btnCancelLabel:"\u53d6\u6d88",btnOKLabel:"\u786e\u8ba4",callback:function(o){if(o){var t="";t="car_type="+e+"&id="+a,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/auth/deleteSystemAuth.action",timeout:6e4,dataType:"json",data:t,success:function(o){var a="";return a=600009==o.result?o.message:ConfigCN[o.result],600002!=o.result?(BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:a,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]}),!1):(MenuLoad(e),void BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:a,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]}))},error:function(e,o,a){"timeout"==o&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}}}):BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u83dc\u5355\u9879\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}MenuLoad(1),MenuLoad(2);