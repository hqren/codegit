function user_edit(id){var data="";data="id="+id,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/queryUpdateUserInfoAndRole.action",dataType:"json",data:data,success:function(jsonResult){var loginName=jsonResult.user.loginName,username=jsonResult.user.username;TempOrgId=jsonResult.user.orgId;var trainBureauId=jsonResult.user.trainBureauIds,trainStationId=jsonResult.user.trainStationIds,trainShopId=jsonResult.user.trainShopIds,RolesIDArray=new Array;$.each(jsonResult.listRole,function(e,a){RolesIDArray.push(a.id)}),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/role/queryAllRole.action",dataType:"json",success:function(jsonResult){var strHtml="",TempQueryAllRole=!0;null!=jsonResult&&0!=jsonResult.length&&$.cookie("id")!=id||(TempQueryAllRole=!1),strHtml+='<div class="row"><div class="col-sm-12"><form id="FormValidator"  class="form-horizontal">',strHtml+='<br><div class="form-group"><label class="col-sm-3 control-label">\u767b\u5f55\u7528\u6237\u540d</label><div class="col-sm-6"><p class="form-control-static">'+loginName+"</p></div></div>",strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u7528\u6237\u59d3\u540d</label><div class="col-sm-6"><input type="text" id="U_Username" name="U_Username" class="form-control" value="'+username+'" placeholder="\u8f93\u5165\u7528\u6237\u59d3\u540d" maxlength="20"></div></div>',$.cookie("id")!=id&&(strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u6240\u5c5e\u90e8\u95e8</label><div id="orgName" class="col-sm-6"><ul id="treeDemo2" class="ztree"></ul></div></div>',strHtml+='<div id="ShowRailwayBureau" style="display:none;">',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u914d\u5c5e\u5c40</label><div class="col-sm-6"><select id="RailwayBureau2" name="RailwayBureau2" class="selectpicker form-control" data-live-search="true" multiple title="\u9009\u62e9\u914d\u5c5e\u5c40"></select></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u914d\u5c5e\u6bb5</label><div class="col-sm-6"><select id="RailwayStation2" name="RailwayStation2" class="selectpicker form-control" data-live-search="true" multiple title="\u9009\u62e9\u914d\u5c5e\u6bb5"></select></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u914d\u5c5e\u8f66\u95f4</label><div class="col-sm-6"><select id="TrainShop2" name="TrainShop2" class="selectpicker form-control" data-live-search="true" multiple title="\u9009\u62e9\u914d\u5c5e\u8f66\u95f4"></select></div></div>',strHtml+="</div>",strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u6240\u5c5e\u89d2\u8272</label><div id="listRoleName" class="col-sm-6"><ul id="treeDemo" class="ztree"></ul></div></div>'),strHtml+="</form></div></div>",BootstrapDialog.show({title:"\u4fee\u6539\u7528\u6237",message:strHtml,onshown:function(dialogRef){$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/queryOrgInstitutionList.action",dataType:"json",success:function(jsonResult2){if(-1==$.cookie("parentId")||""==$.cookie("parentId")){var setting={check:{enable:!0,chkStyle:"radio"},data:{simpleData:{enable:!0}},callback:{beforeCheck:beforeCheck2}},treeNodeArray=new Array,treeNodeObject=new Object;$.each(jsonResult2,function(e,a){var t=new Object;t.id=a.id,-1==a.parentId?(t.pId=0,t.doCheck=!1):t.pId=a.parentId,t.name=a.orgName,treeNodeArray.push(t)});var zNodes=eval(treeNodeArray);setting.check.radioType="all",$.fn.zTree.init($("#treeDemo2"),setting,zNodes)}else $("#orgName").html('<p class="form-control-static">'+$.cookie("departmentName")+"</p>");if(1==TempQueryAllRole){var setting={check:{enable:!0},data:{simpleData:{enable:!0}}},treeNodeArray=new Array,treeNodeObject=new Object;treeNodeObject.id=0,treeNodeObject.name="\u5168\u90e8",treeNodeObject.open=!0,treeNodeArray.push(treeNodeObject),$.each(jsonResult,function(e,a){var t=new Object;t.id=a.id,t.pId=0,t.name=a.roleName,treeNodeArray.push(t)});var zNodes=eval(treeNodeArray);if($.fn.zTree.init($("#treeDemo"),setting,zNodes),RolesIDArray.length>0){var zTree=$.fn.zTree.getZTreeObj("treeDemo");$.each(RolesIDArray,function(e,a){zTree.checkNode(zTree.getNodeByParam("id",a),!0)})}}else $("#listRoleName").html('<p class="form-control-static">\u8bf7\u5148\u521b\u5efa\u89d2\u8272 <a href="list_user_js.html">\u53bb\u6dfb\u52a0</a></p>');if($(".selectpicker").selectpicker("refresh"),-1==$.cookie("parentId")||""==$.cookie("parentId")){var zTree2=$.fn.zTree.getZTreeObj("treeDemo2");zTree2.checkNode(zTree2.getNodeByParam("id",TempOrgId),!0)}12==TempOrgId?$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getRailwayBureau.action",dataType:"json",success:function(e){$("#ShowRailwayBureau").show(),$("#RailwayBureau2").html("");var a=trainBureauId.split(",");$.each(e,function(e,a){if("\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")){var t=$.cookie("trainBureauIds"),o=t.split(",");o.indexOf(a.value)>-1&&$("#RailwayBureau2").append('<option value="'+a.value+'">'+a.text+"</option>")}else $("#RailwayBureau2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh"),$("#RailwayBureau2").selectpicker("val",a);var t="";t="trainBureauId="+trainBureauId,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainStationByBureauId.action",dataType:"json",data:t,success:function(e){$("#RailwayStation2").html(""),$.each(e,function(e,a){$("#RailwayStation2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh");var a=trainStationId.split(",");$("#RailwayStation2").selectpicker("val",a),$(".selectpicker").selectpicker("refresh");var t="";t="&trainStationId="+trainStationId,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainShopByBureauIdStationId.action",dataType:"json",data:t,success:function(e){$("#TrainShop2").html(""),$.each(e,function(e,a){$("#TrainShop2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh");var a=trainShopId.split(",");$("#TrainShop2").selectpicker("val",a),$(".selectpicker").selectpicker("refresh"),FormValidator()},error:function(){FormValidator(),errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u8f66\u95f4\u4fe1\u606f\uff01")}})},error:function(){FormValidator(),errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u6bb5\u4fe1\u606f\uff01")}})},error:function(){FormValidator(),errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u5c40\u4fe1\u606f\uff01")}}):FormValidator(),$("#RailwayBureau2").change(function(){if(""!=$(this).val()){var e="";e="trainBureauId="+$(this).val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainStationByBureauId.action",dataType:"json",data:e,success:function(e){$("#RailwayStation2").html(""),$("#TrainShop2").html(""),$.each(e,function(e,a){$("#RailwayStation2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u6bb5\u4fe1\u606f\uff01")}})}else $("#RailwayStation2").html(""),$("#TrainShop2").html(""),$(".selectpicker").selectpicker("refresh")}),$("#RailwayStation2").change(function(){if(""!=$(this).val()){var e="";e="&trainStationId="+$(this).val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainShopByBureauIdStationId.action",dataType:"json",data:e,success:function(e){$("#TrainShop2").html(""),$.each(e,function(e,a){$("#TrainShop2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u8f66\u95f4\u4fe1\u606f\uff01")}})}else $("#TrainShop2").html(""),$(".selectpicker").selectpicker("refresh")})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff01")}})},buttons:[{label:"\u63d0\u4ea4",cssClass:"btn-primary",action:function(e){if($("#FormValidator").bootstrapValidator("validate"),$("#FormValidator").data("bootstrapValidator").isValid()){var a=new Array,t=new Array;if(1==TempQueryAllRole){var o=$.fn.zTree.getZTreeObj("treeDemo"),l=o.getCheckedNodes();$.each(l,function(e,t){void 0==t.children&&a.push(t.id)});var r=$.fn.zTree.getZTreeObj("treeDemo2");if(-1==$.cookie("parentId")||""==$.cookie("parentId")){var i=r.getCheckedNodes();$.each(i,function(e,a){t.push(a.id)})}else t.push($.cookie("orgId"))}if(0==t.length){if(d=$.cookie("id")==id?"id="+id+"&username="+$("#U_Username").val()+"&roleIds="+String(RolesIDArray)+"&orgId="+TempOrgId:"id="+id+"&username="+$("#U_Username").val()+"&roleIds="+String(a)+"&orgId="+TempOrgId,"\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")){var s=$("#RailwayBureau2").val(),n=$("#RailwayStation2").val(),c=$("#TrainShop2").val();d+="&trainBureauIds="+CheckNull(s)+"&trainStationIds="+CheckNull(n)+"&trainShopIds="+CheckNull(c)}$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/updateUserAndRole.action",timeout:6e4,dataType:"json",data:d,success:function(a){var t="";t=600009==a.result?a.message:ConfigCN[a.result],600005==a.result&&($("#table-user").bootstrapTable("refresh"),e.close()),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}else if(t.length>0){var d="";if(d="id="+id+"&username="+$("#U_Username").val()+"&roleIds="+String(a)+"&orgId="+String(t),12==TempOrgId||"\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")){var s=$("#RailwayBureau2").val(),n=$("#RailwayStation2").val(),c=$("#TrainShop2").val();d+="&trainBureauIds="+CheckNull(s)+"&trainStationIds="+CheckNull(n)+"&trainShopIds="+CheckNull(c)}$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/updateUserAndRole.action",timeout:6e4,dataType:"json",data:d,success:function(a){var t="";t=600009==a.result?a.message:ConfigCN[a.result],600005==a.result&&($("#table-user").bootstrapTable("refresh"),e.close()),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}else BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u9009\u62e9\u6240\u5c5e\u90e8\u95e8",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}else BootstrapDialog.alert({title:"\u9a8c\u8bc1\u5931\u8d25",message:"\u8bf7\u786e\u8ba4\u8f93\u5165\u5185\u5bb9\u683c\u5f0f\u662f\u5426\u6b63\u786e\uff01",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"\u786e\u8ba4"})}},{label:"\u91cd\u7f6e",action:function(e){$("#FormValidator").data("bootstrapValidator").resetForm(!0),$("#RailwayStation2").html('<option value="">\u9009\u62e9\u914d\u5c5e\u6bb5</option>'),$("#TrainShop2").html('<option value="">\u9009\u62e9\u914d\u5c5e\u8f66\u95f4</option>'),$(".selectpicker").selectpicker("refresh");$.fn.zTree.getZTreeObj("treeDemo").checkAllNodes(!1);if($.cookie("id")!=id)var a=$.fn.zTree.getZTreeObj("treeDemo2");-1==$.cookie("parentId")&&a.checkNode(a.getNodeByParam("id",TempOrgId),!1)}},{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u89d2\u8272\u4fe1\u606f\uff01")}})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff01")}})}function user_read(e){var a="";a="id="+e,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/queryUserInfoById.action",dataType:"json",data:a,success:function(a){var t,o,l,r,i,s,n,c,d,u,p="";t=a.id,o=a.authUserId,""==o&&(o=e),l=a.gender,r=a.phone,i=a.mobile,s=a.email,n=a.qq,c=a.office,d=a.region,u=a.department,p+='<div class="row"><div class="col-sm-12"><form id="FormValidator"  class="form-horizontal">',p+='<div class="form-group"><label class="col-sm-3 control-label">\u6027\u522b</label><div class="col-sm-6 btn-group" data-toggle="buttons" id="gender"><label class="btn btn-primary"><input type="radio" name="gender" value="0" class="radioItem" checked="checked">\u672a\u77e5</label><label class="btn btn-primary"><input type="radio" name="gender" value="1" class="radioItem">\u7537</label><label class="btn btn-primary"><input type="radio" name="gender" value="2" class="radioItem">\u5973</label></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">\u8054\u7cfb\u7535\u8bdd</label><div class="col-sm-6"><input type="text" id="phone" name="phone" class="form-control" value="'+r+'" placeholder="\u8bf7\u8f93\u5165\u8054\u7cfb\u7535\u8bdd" maxlength="20"></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">\u624b\u673a\u53f7\u7801</label><div class="col-sm-6"><input type="tel" id="mobile" name="mobile" class="form-control" value="'+i+'" placeholder="\u8bf7\u8f93\u516511\u4f4d\u624b\u673a\u53f7\u7801" maxlength="11"></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">\u7535\u5b50\u90ae\u7bb1</label><div class="col-sm-6"><input type="mail" id="email" name="email" class="form-control" value="'+s+'" placeholder="\u7535\u5b50\u90ae\u7bb1\u5730\u5740" maxlength="30"></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">QQ\u53f7\u7801</label><div class="col-sm-6"><input type="tel" id="qq" name="qq" class="form-control" value="'+n+'"" placeholder="\u8bf7\u8f93\u5165QQ\u53f7\u7801" maxlength="15"></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">\u8054\u7cfb\u5730\u5740</label><div class="col-sm-6"><input type="text" id="address" name="address" class="form-control" value="'+c+'" placeholder="\u8bf7\u8f93\u5165\u8054\u7cfb\u5730\u5740" maxlength="100"></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">\u529e\u516c\u5730\u5740</label><div class="col-sm-6"><input type="text" id="office" name="office" class="form-control" value="'+c+'" placeholder="\u8bf7\u8f93\u5165\u529e\u516c\u5730\u5740" maxlength="100"></div></div>',p+='<div class="form-group"><label class="col-sm-3 control-label">\u6240\u5c5e\u5730\u533a</label><div class="col-sm-6"><input type="text" id="region" name="region" class="form-control" value="'+d+'" placeholder="\u8bf7\u8f93\u5165\u6240\u5728\u5730\u533a\uff0c\u5982\u5317\u4eac"></div></div>',p+="</form></div></div>",BootstrapDialog.show({title:"\u7528\u6237\u9644\u52a0\u4fe1\u606f",message:p,onshown:function(e){null!=t?($("#gender label").removeClass("active"),$("#gender label").eq(l).addClass("active"),$("#gender.radioItem").removeAttr("checked"),$("#gender.radioItem").eq(l).attr("checked","checked")):($("#gender label").removeClass("active"),$("#gender label").eq(0).addClass("active"),$("#gender.radioItem").removeAttr("checked"),$("#gender.radioItem").eq(0).attr("checked","checked")),$("#FormValidator").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{phone:{message:"\u8054\u7cfb\u7535\u8bdd\u65e0\u6548",validators:{regexp:{regexp:/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/,message:"\u8054\u7cfb\u7535\u8bdd\u683c\u5f0f\u4e0d\u6b63\u786e \u4f8b\uff1a010-88012345"}}},mobile:{message:"\u624b\u673a\u53f7\u7801\u65e0\u6548",validators:{regexp:{regexp:/^1[3|4|5|7|8]\d{9}$/,message:"\u624b\u673a\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e \u4f8b\uff1a137********"}}},email:{validators:{regexp:{regexp:/^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/,message:"\u90ae\u7bb1\u5730\u5740\u683c\u5f0f\u4e0d\u6b63\u786e \u4f8b\uff1axxx@xxx.com"}}},qq:{message:"\u624b\u673a\u53f7\u7801\u65e0\u6548",validators:{stringLength:{max:15,message:"QQ\u53f7\u7801\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e15\u4f4d\u6570"}}},address:{message:"\u8054\u7cfb\u5730\u5740\u65e0\u6548",validators:{}},office:{message:"\u529e\u516c\u5730\u5740\u65e0\u6548",validators:{}},region:{message:"\u6240\u5c5e\u5730\u533a\u65e0\u6548",validators:{}}}})},buttons:[{label:"\u63d0\u4ea4",cssClass:"btn-primary",action:function(e){if($("#FormValidator").bootstrapValidator("validate"),$("#FormValidator").data("bootstrapValidator").isValid()){gerder=$('input:radio[name="gender"]:checked').val(),void 0==gerder&&(gerder=0);var a="";a="id="+t+"&authUserId="+o+"&gender="+gerder+"&phone="+$("#phone").val()+"&mobile="+$("#mobile").val()+"&email="+$("#email").val()+"&qq="+$("#qq").val()+"&address="+$("#address").val()+"&office="+$("#office").val()+"&region="+$("#region").val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/addOrUpdateUserInfoExpand.action",timeout:6e4,dataType:"json",data:a,success:function(a){var t="";t=600009==a.result?a.message:ConfigCN[a.result],6e5==a.result?($("#table-user").bootstrapTable("refresh"),e.close()):600005==a.result&&($("#table-user").bootstrapTable("refresh"),e.close()),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}else BootstrapDialog.alert({title:"\u9a8c\u8bc1\u5931\u8d25",message:"\u8bf7\u786e\u8ba4\u8f93\u5165\u5185\u5bb9\u683c\u5f0f\u662f\u5426\u6b63\u786e\uff01",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"\u786e\u8ba4"})}},{label:"\u91cd\u7f6e",action:function(e){$("#FormValidator").data("bootstrapValidator").resetForm(!0),$("#gender label").removeClass("active"),$("#gender label").eq(0).addClass("active"),$("#gender .radioItem").removeAttr("checked"),$("#gender .radioItem").eq(0).attr("checked","checked"),$(".selectpicker").selectpicker("refresh")}},{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u9644\u52a0\u4fe1\u606f\uff01")}})}function user_edit_password(e){var a="";a+='<div class="row"><div class="col-sm-12"><form id="FormValidator"  class="form-horizontal">',a+='<div class="form-group"><label class="col-sm-3 control-label">\u5bc6\u7801</label><div class="col-sm-6"><input type="text" id="U_Password" name="U_Password" class="form-control" placeholder="\u8f93\u5165\u5bc6\u7801" onfocus="this.type=\'password\'" maxlength="20"></div></div>',a+="</form></div></div>",BootstrapDialog.show({title:"\u4fee\u6539\u5bc6\u7801",message:a,onshown:function(e){$("#FormValidator").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{U_Password:{message:"\u5bc6\u7801\u65e0\u6548",validators:{notEmpty:{message:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"},stringLength:{min:6,max:20,message:"\u5bc6\u7801\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e6\u4f4d\u6570\u4e14\u5c0f\u4e8e\u7b49\u4e8e20\u4f4d\u6570"}}}}})},buttons:[{label:"\u63d0\u4ea4",cssClass:"btn-primary",action:function(a){if($("#FormValidator").bootstrapValidator("validate"),$("#FormValidator").data("bootstrapValidator").isValid()){var t="";t="id="+e+"&password="+$("#U_Password").val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/userCenterAdminUpdatePassword.action",timeout:6e4,dataType:"json",data:t,success:function(e){var t="";t=600009==e.result?e.message:ConfigCN[e.result],600005==e.result&&a.close(),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}else BootstrapDialog.alert({title:"\u9a8c\u8bc1\u5931\u8d25",message:"\u8bf7\u786e\u8ba4\u8f93\u5165\u5185\u5bb9\u683c\u5f0f\u662f\u5426\u6b63\u786e\uff01",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"\u786e\u8ba4"})}},{label:"\u91cd\u7f6e",action:function(e){$("#FormValidator").data("bootstrapValidator").resetForm(!0)}},{label:"\u5173\u95ed",action:function(e){e.close()}}]})}function user_delOne(e){BootstrapDialog.confirm({title:"\u5220\u9664\u786e\u8ba4\u63d0\u9192",message:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u6240\u9009\u62e9\u7528\u6237\uff1f",closable:!0,draggable:!0,btnCancelLabel:"\u53d6\u6d88",btnOKLabel:"\u786e\u8ba4",callback:function(a){if(a){var t="";t="id="+e,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/deleteUserInfo.action",timeout:6e4,dataType:"json",data:t,success:function(e){var a="";return a=600009==e.result?e.message:ConfigCN[e.result],600002!=e.result?(BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:a,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]}),!1):($("#table-user").bootstrapTable("refresh"),void BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:a,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]}))},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}}})}function queryParams_user(e){var a={limit:e.limit,offset:e.offset,loginName:$("#serach_loginName").val(),trainBureauId:$("#RailwayBureau").val(),trainStationId:$("#RailwayStation").val(),trainShopId:$("#TrainShop").val()};return a}function FormValidator(){$("#FormValidator").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{U_LoginName:{message:"\u7528\u6237\u767b\u5f55\u540d\u65e0\u6548",validators:{notEmpty:{message:"\u7528\u6237\u767b\u5f55\u540d\u4e0d\u80fd\u4e3a\u7a7a"},stringLength:{min:5,max:20,message:"\u7528\u6237\u540d\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e5\u4f4d\u6570\u4e14\u5c0f\u4e8e\u7b49\u4e8e20\u4f4d\u6570"},threshold:5,remote:{url:"system/user/checkUserByLoginName.action",message:"\u767b\u5f55\u7528\u6237\u540d\u5df2\u5b58\u5728\uff01",delay:1e3,type:"POST",data:function(e){return{loginName:$("#U_LoginName").val()}}}}},U_Password:{message:"\u5bc6\u7801\u65e0\u6548",validators:{notEmpty:{message:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"},stringLength:{min:6,max:20,message:"\u5bc6\u7801\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e6\u4f4d\u6570\u4e14\u5c0f\u4e8e\u7b49\u4e8e20\u4f4d\u6570"}}},U_Username:{message:"\u7528\u6237\u59d3\u540d\u65e0\u6548",validators:{notEmpty:{message:"\u7528\u6237\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a"}}},RailwayBureau2:{message:"\u914d\u5c5e\u5c40\u65e0\u6548",validators:{notEmpty:{message:"\u8bf7\u9009\u62e9\u914d\u5c5e\u5c40"}}}}})}function beforeCheck2(e,a){TempOrgId=a.id,12==TempOrgId?$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getRailwayBureau.action",dataType:"json",success:function(e){$("#ShowRailwayBureau").show(),$("#RailwayBureau2").html(""),$.each(e,function(e,a){$("#RailwayBureau2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$("#RailwayStation2").html(""),$("#TrainShop2").html(""),$(".selectpicker").selectpicker("refresh"),$("#FormValidator").data("bootstrapValidator").updateStatus("RailwayBureau2","NOT_VALIDATED",null).validateField("RailwayBureau2"),$("#FormValidator").data("bootstrapValidator").updateStatus("RailwayStation2","NOT_VALIDATED",null).validateField("RailwayStation2"),$("#FormValidator").data("bootstrapValidator").updateStatus("TrainShop2","NOT_VALIDATED",null).validateField("TrainShop2"),$("#ShowRailwayBureau").show()},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u6bb5\u4fe1\u606f\uff01")}}):(TempOrgId="",$("#ShowRailwayBureau").hide())}2==car_type&&$(".RailwayBureau,.RailwayStation,.TrainShop").hide();var TempOrgName="",TempOrgId="",$table=$("#table-user");$table.bootstrapTable({method:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/queryUserInfoByPage.action",dataType:"json",striped:!0,toolbar:"#toolbar",uniqueId:"trainLineId",pagination:!0,singleSelect:!1,idField:"trainLineId",sortable:!1,sidePagination:"server",queryParams:queryParams_user,columns:[{title:"\u5e8f\u53f7",field:"id",align:"center",valign:"middle",formatter:function(e,a,t){return t+1}},{title:"\u767b\u5f55\u8d26\u53f7\u540d",field:"loginName",align:"center",valign:"middle"},{title:"\u59d3\u540d",field:"username",align:"center",valign:"middle"},{title:"\u89d2\u8272\u540d",field:"roleName",align:"center",valign:"middle"},{title:"\u6240\u5c5e\u90e8\u95e8",field:"departmentName",align:"center",valign:"middle"},{title:"\u64cd\u4f5c",field:"cz",align:"center",valign:"middle",formatter:function(e,a,t){var o="";return o=UID!=a.id?'<button class="btn btn-primary" type="submit" onclick="user_read('+a.id+');">\u4fe1\u606f</button> <button class="btn btn-primary" type="submit" onclick="user_edit('+a.id+');">\u4fee\u6539</button> <button class="btn btn-primary" type="submit" onclick="user_edit_password('+a.id+');">\u91cd\u7f6e\u5bc6\u7801</button> <button class="btn btn-primary" type="submit" onclick="user_delOne('+a.id+');">\u5220\u9664</button>':'<button class="btn btn-primary" type="submit" onclick="user_read('+a.id+');">\u4fe1\u606f</button> <button class="btn btn-primary" type="submit" onclick="user_edit('+a.id+');">\u4fee\u6539</button>'}}]}),$("#user_add").click(function(){$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/role/queryAllRole.action",dataType:"json",success:function(jsonResult){var strHtml="",TempQueryAllRole=!0;null!=jsonResult&&0!=jsonResult.length||(TempQueryAllRole=!1),strHtml+='<div class="row"><div class="col-sm-12"><form id="FormValidator" class="form-horizontal">',strHtml+='<br><div class="form-group"><label class="col-sm-3 control-label">\u767b\u5f55\u7528\u6237\u540d</label><div class="col-sm-6"><input type="text" id="U_LoginName" name="U_LoginName" class="form-control" placeholder="\u8f93\u5165\u767b\u5f55\u7528\u6237\u540d" maxlength="20"></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u5bc6\u7801</label><div class="col-sm-6"><input type="text" id="U_Password" name="U_Password" class="form-control" placeholder="\u8f93\u5165\u5bc6\u7801" onfocus="this.type=\'password\'" maxlength="20"></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u7528\u6237\u59d3\u540d</label><div class="col-sm-6"><input type="text" id="U_Username" name="U_Username" class="form-control" placeholder="\u8f93\u5165\u7528\u6237\u59d3\u540d"></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u6240\u5c5e\u90e8\u95e8</label><div id="orgName" class="col-sm-6"><ul id="treeDemo2" class="ztree"></ul></div></div>',strHtml+='<div id="ShowRailwayBureau" style="display:none;">',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u914d\u5c5e\u5c40</label><div class="col-sm-6"><select id="RailwayBureau2" name="RailwayBureau2" class="selectpicker form-control" data-live-search="true" multiple title="\u9009\u62e9\u914d\u5c5e\u5c40"></select></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u914d\u5c5e\u6bb5</label><div class="col-sm-6"><select id="RailwayStation2" name="RailwayStation2" class="selectpicker form-control" data-live-search="true" multiple title="\u9009\u62e9\u914d\u5c5e\u6bb5"></select></div></div>',strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u914d\u5c5e\u8f66\u95f4</label><div class="col-sm-6"><select id="TrainShop2" name="TrainShop2" class="selectpicker form-control" data-live-search="true" multiple title="\u9009\u62e9\u914d\u5c5e\u8f66\u95f4"></select></div></div>',strHtml+="</div>",strHtml+='<div class="form-group"><label class="col-sm-3 control-label">\u6240\u5c5e\u89d2\u8272</label><div id="listRoleName" class="col-sm-6"><ul id="treeDemo" class="ztree"></ul></div></div>',strHtml+="</form></div></div>",BootstrapDialog.show({title:"\u6dfb\u52a0\u7528\u6237",message:strHtml,onshown:function(dialogRef){$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/queryOrgInstitutionList.action",dataType:"json",success:function(jsonResult2){if(-1==$.cookie("parentId")||""==$.cookie("parentId")){var setting={check:{enable:!0,chkStyle:"radio"},data:{simpleData:{enable:!0}},callback:{beforeCheck:beforeCheck2}},treeNodeArray=new Array,treeNodeObject=new Object;$.each(jsonResult2,function(e,a){var t=new Object;t.id=a.id,-1==a.parentId?t.pId=0:t.pId=a.parentId,t.name=a.orgName,treeNodeArray.push(t)});var zNodes=eval(treeNodeArray);setting.check.radioType="all",$.fn.zTree.init($("#treeDemo2"),setting,zNodes)}else $("#orgName").html('<p class="form-control-static">'+$.cookie("departmentName")+"</p>"),"\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")&&$("#ShowRailwayBureau").show();if(1==TempQueryAllRole){var setting={check:{enable:!0},data:{simpleData:{enable:!0}}},treeNodeArray=new Array,treeNodeObject=new Object;treeNodeObject.id=0,treeNodeObject.name="\u5168\u90e8",treeNodeObject.open=!0,treeNodeArray.push(treeNodeObject),$.each(jsonResult,function(e,a){var t=new Object;t.id=a.id,t.pId=0,t.name=a.roleName,treeNodeArray.push(t)});var zNodes=eval(treeNodeArray);$.fn.zTree.init($("#treeDemo"),setting,zNodes)}else $("#listRoleName").html('<p class="form-control-static">\u8bf7\u5148\u521b\u5efa\u89d2\u8272 <a href="list_user_js.html">\u53bb\u521b\u5efa</a></p>');"\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")&&$("#ShowRailwayBureau").show();var trainBureauId=$.cookie("trainBureauIds"),trainStationId=$.cookie("trainStationIds"),trainShopId=$.cookie("trainShopIds");$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getRailwayBureau.action",dataType:"json",success:function(e){var a="",t=trainBureauId.split(",");$.each(e,function(e,o){"\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")?t.indexOf(o.value)>-1&&(a+='<option value="'+o.value+'">'+o.text+"</option>"):a+='<option value="'+o.value+'">'+o.text+"</option>"}),$("#RailwayBureau2").html(a),$(".selectpicker").selectpicker("refresh"),$("#RailwayBureau2").selectpicker("val",t);var o="";o="trainBureauId="+trainBureauId,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainStationByBureauId.action",dataType:"json",data:o,success:function(e){$("#RailwayStation2").html(""),$.each(e,function(e,a){$("#RailwayStation2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh");var a=trainStationId.split(",");$("#RailwayStation2").selectpicker("val",a),$(".selectpicker").selectpicker("refresh");var t="";t="&trainStationId="+trainStationId,$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainShopByBureauIdStationId.action",dataType:"json",data:t,success:function(e){$("#TrainShop2").html(""),$.each(e,function(e,a){$("#TrainShop2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh");var a=trainShopId.split(",");$("#TrainShop2").selectpicker("val",a),$(".selectpicker").selectpicker("refresh"),FormValidator()},error:function(){FormValidator(),errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u8f66\u95f4\u4fe1\u606f\uff01")}})},error:function(){FormValidator(),errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u6bb5\u4fe1\u606f\uff01")}}),$("#RailwayBureau2").change(function(){if(""!=$(this).val()){var e="";e="trainBureauId="+$(this).val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainStationByBureauId.action",dataType:"json",data:e,success:function(e){$("#RailwayStation2").html(""),$.each(e,function(e,a){$("#RailwayStation2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u6bb5\u4fe1\u606f\uff01")}})}else $("#TrainShop2").html(""),$(".selectpicker").selectpicker("refresh")}),$("#RailwayStation2").change(function(){if(""!=$(this).val()){var e="";e="&trainStationId="+$(this).val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/train/queryTrainShopByBureauIdStationId.action",dataType:"json",data:e,success:function(e){$("#TrainShop2").html(""),$.each(e,function(e,a){$("#TrainShop2").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u8f66\u95f4\u4fe1\u606f\uff01")}})}else $("#TrainShop2").html(""),$(".selectpicker").selectpicker("refresh")}),FormValidator()},error:function(){FormValidator(),errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u5c40\u4fe1\u606f\uff01")}})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u6240\u5c5e\u90e8\u95e8\u4fe1\u606f\uff01")}})},buttons:[{label:"\u63d0\u4ea4",cssClass:"btn-primary",action:function(e){if($("#FormValidator").bootstrapValidator("validate"),$("#FormValidator").data("bootstrapValidator").isValid()){var a="";a="loginName="+$("#U_LoginName").val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/checkUserByLoginName.action",timeout:6e4,dataType:"json",data:a,success:function(a){if(1==a.isExist)BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u767b\u5f55\u7528\u6237\u540d\u5df2\u5b58\u5728\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]});else{var t=new Array;if(1==TempQueryAllRole){var o=$.fn.zTree.getZTreeObj("treeDemo"),l=o.getCheckedNodes();$.each(l,function(e,a){void 0==a.children&&t.push(a.id)})}var r=new Array;if(-1==$.cookie("parentId")||""==$.cookie("parentId")){var i=$.fn.zTree.getZTreeObj("treeDemo2"),s=i.getCheckedNodes();$.each(s,function(e,a){""==$.cookie("parentId")?r.push(a.id):void 0==a.children&&r.push(a.id)})}else r.push($.cookie("orgId"));if(r.length>0){var n="";if(n="loginName="+$("#U_LoginName").val()+"&username="+$("#U_Username").val()+"&password="+$("#U_Password").val()+"&roleIds="+String(t)+"&orgId="+String(r),12==TempOrgId||"\u8fd0\u7ef4\u90e8"==$.cookie("departmentName")){var c=$("#RailwayBureau2").val(),d=$("#RailwayStation2").val(),u=$("#TrainShop2").val();n+="&trainBureauIds="+CheckNull(c)+"&trainStationIds="+CheckNull(d)+"&trainShopIds="+CheckNull(u)}$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"system/user/addUserAndRole.action",timeout:6e4,dataType:"json",data:n,success:function(a){var t="";t=600009==a.result?a.message:ConfigCN[a.result],6e5==a.result&&($("#table-user").bootstrapTable("refresh"),e.close()),BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:t,buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}else BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u9009\u62e9\u6240\u5c5e\u90e8\u95e8",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}},error:function(e,a,t){"timeout"==a&&BootstrapDialog.show({title:"\u7cfb\u7edf\u63d0\u793a",message:"\u8bf7\u6c42\u8d85\u65f6\uff01",buttons:[{label:"\u5173\u95ed",action:function(e){e.close()}}]})}})}else BootstrapDialog.alert({title:"\u9a8c\u8bc1\u5931\u8d25",message:"\u8bf7\u786e\u8ba4\u8f93\u5165\u5185\u5bb9\u683c\u5f0f\u662f\u5426\u6b63\u786e\uff01",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"\u786e\u8ba4"})}},{label:"\u91cd\u7f6e",action:function(e){$("#FormValidator").data("bootstrapValidator").resetForm(!0),$("#RailwayStation2").html('<option value="">\u9009\u62e9\u914d\u5c5e\u6bb5</option>'),$("#TrainShop2").html('<option value="">\u9009\u62e9\u914d\u5c5e\u8f66\u95f4</option>'),$(".selectpicker").selectpicker("refresh");var a=($.fn.zTree.getZTreeObj("treeDemo").checkAllNodes(!1),$.fn.zTree.getZTreeObj("treeDemo2"));a.checkNode(a.getNodeByParam("id",TempOrgId),!1)}},{label:"\u5173\u95ed",action:function(e){e.close()}}]})},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u7528\u6237\u89d2\u8272\u4fe1\u606f\uff01")}})}),$("#serach_button").click(function(){$("#table-user").bootstrapTable("refresh");
}),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getRailwayBureau.action",dataType:"json",success:function(e){$.each(e,function(e,a){$("#RailwayBureau").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u5c40\u4fe1\u606f\uff01")}}),$("#RailwayBureau").change(function(){if(""!=$(this).val()){var e="";e="trainBureauId="+$(this).val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getRailwayStation.action",dataType:"json",data:e,success:function(e){$("#RailwayStation").html('<option value="">\u9009\u62e9\u914d\u5c5e\u6bb5</option>'),$("#TrainShop").html('<option value="">\u9009\u62e9\u914d\u5c5e\u8f66\u95f4</option>'),$.each(e,function(e,a){$("#RailwayStation").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u6bb5\u4fe1\u606f\uff01")}})}else $("#RailwayStation").html('<option value="">\u9009\u62e9\u914d\u5c5e\u6bb5</option>'),$("#TrainShop").html('<option value="">\u9009\u62e9\u914d\u5c5e\u8f66\u95f4</option>'),$(".selectpicker").selectpicker("refresh")}),$("#RailwayStation").change(function(){if(""!=$(this).val()){var e="";e="trainBureauId="+$("#RailwayBureau").val()+"&trainStationId="+$(this).val(),$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:"selectObject/getRailwayShop.action",dataType:"json",data:e,success:function(e){$("#TrainShop").html('<option value="">\u9009\u62e9\u914d\u5c5e\u8f66\u95f4</option>'),$.each(e,function(e,a){$("#TrainShop").append('<option value="'+a.value+'">'+a.text+"</option>")}),$(".selectpicker").selectpicker("refresh")},error:function(){errorNotify(null,"\u65e0\u6cd5\u83b7\u53d6\u914d\u5c5e\u8f66\u95f4\u4fe1\u606f\uff01")}})}else $("#TrainShop").html('<option value="">\u9009\u62e9\u914d\u5c5e\u8f66\u95f4</option>'),$(".selectpicker").selectpicker("refresh")});